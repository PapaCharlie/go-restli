/*
Code generated by "github.com/PapaCharlie/go-restli"; DO NOT EDIT.

Source file: /Users/pchesnai/code/personal/go-restli/spec-parser/build/libs/go-restli-spec-parser-2.0.2.jar
*/

package common

import (
	"github.com/PapaCharlie/go-restli/fnv1a"
	"github.com/PapaCharlie/go-restli/restli/patch"
	"github.com/PapaCharlie/go-restli/restlicodec"
)

// A atom:link-inspired link
type Link struct {
	// The link relation e.g. 'self' or 'next'
	Rel string
	// The link URI
	Href string
	// The type (media type) of the resource
	Type string
}

func (l *Link) Equals(other *Link) bool {
	if l == other {
		return true
	}
	if l == nil || other == nil {
		return false
	}

	return l.Rel == other.Rel &&
		l.Href == other.Href &&
		l.Type == other.Type
}

func (l *Link) ComputeHash() fnv1a.Hash {
	if l == nil {
		return fnv1a.ZeroHash()
	}
	hash := fnv1a.NewHash()

	hash.AddString(l.Rel)

	hash.AddString(l.Href)

	hash.AddString(l.Type)

	return hash
}

func (l *Link) MarshalFields(keyWriter func(string) restlicodec.Writer) (err error) {
	keyWriter("href").WriteString(l.Href)
	keyWriter("rel").WriteString(l.Rel)
	keyWriter("type").WriteString(l.Type)
	return nil
}

func (l *Link) MarshalRestLi(writer restlicodec.Writer) (err error) {
	return writer.WriteMap(l.MarshalFields)
}

func (l *Link) MarshalJSON() (data []byte, err error) {
	writer := restlicodec.NewCompactJsonWriter()
	err = l.MarshalRestLi(writer)
	if err != nil {
		return nil, err
	}
	return []byte(writer.Finalize()), nil
}

var LinkRequiredFields = restlicodec.NewRequiredFields().Add(
	"rel",
	"href",
	"type",
)

func (l *Link) UnmarshalField(reader restlicodec.Reader, field string) (found bool, err error) {
	switch field {
	case "rel":
		found = true
		l.Rel, err = reader.ReadString()
	case "href":
		found = true
		l.Href, err = reader.ReadString()
	case "type":
		found = true
		l.Type, err = reader.ReadString()
	}
	return found, err
}

func (l *Link) UnmarshalRestLi(reader restlicodec.Reader) (err error) {
	err = reader.ReadRecord(LinkRequiredFields, func(reader restlicodec.Reader, field string) (err error) {
		found, err := l.UnmarshalField(reader, field)
		if err != nil {
			return err
		}
		if !found {
			err = reader.Skip()
		}
		return err
	})
	if err != nil {
		return err
	}

	return nil
}

func (l *Link) UnmarshalJSON(data []byte) error {
	return restlicodec.UnmarshalJSON(data, l)
}

func (l *Link) NewInstance() *Link {
	return new(Link)
}

/*
================================================================================
PARTIAL UPDATE STRUCTS
================================================================================
*/

type Link_PartialUpdate_Set_Fields struct {
	// rel
	Rel *string
	// href
	Href *string
	// type
	Type *string
}

func (l *Link_PartialUpdate_Set_Fields) MarshalFields(keyWriter func(string) restlicodec.Writer) (err error) {
	if l.Href != nil {
		keyWriter("href").WriteString(*l.Href)
	}
	if l.Rel != nil {
		keyWriter("rel").WriteString(*l.Rel)
	}
	if l.Type != nil {
		keyWriter("type").WriteString(*l.Type)
	}
	return nil
}

func (l *Link_PartialUpdate_Set_Fields) MarshalRestLi(writer restlicodec.Writer) (err error) {
	return writer.WriteMap(l.MarshalFields)
}

func (l *Link_PartialUpdate_Set_Fields) MarshalJSON() (data []byte, err error) {
	writer := restlicodec.NewCompactJsonWriter()
	err = l.MarshalRestLi(writer)
	if err != nil {
		return nil, err
	}
	return []byte(writer.Finalize()), nil
}

var Link_PartialUpdate_Set_FieldsRequiredFields = restlicodec.NewRequiredFields()

func (l *Link_PartialUpdate_Set_Fields) UnmarshalField(reader restlicodec.Reader, field string) (found bool, err error) {
	switch field {
	case "rel":
		found = true
		l.Rel = new(string)
		*l.Rel, err = reader.ReadString()
	case "href":
		found = true
		l.Href = new(string)
		*l.Href, err = reader.ReadString()
	case "type":
		found = true
		l.Type = new(string)
		*l.Type, err = reader.ReadString()
	}
	return found, err
}

func (l *Link_PartialUpdate_Set_Fields) UnmarshalRestLi(reader restlicodec.Reader) (err error) {
	err = reader.ReadRecord(Link_PartialUpdate_Set_FieldsRequiredFields, func(reader restlicodec.Reader, field string) (err error) {
		found, err := l.UnmarshalField(reader, field)
		if err != nil {
			return err
		}
		if !found {
			err = reader.Skip()
		}
		return err
	})
	if err != nil {
		return err
	}

	return nil
}

func (l *Link_PartialUpdate_Set_Fields) UnmarshalJSON(data []byte) error {
	return restlicodec.UnmarshalJSON(data, l)
}

func (l *Link_PartialUpdate_Set_Fields) NewInstance() *Link_PartialUpdate_Set_Fields {
	return new(Link_PartialUpdate_Set_Fields)
}

// Link_PartialUpdate is used to represent a partial update on Link. Toggling the value of a field
// in Delete represents selecting it for deletion in a partial update, while
// setting the value of a field in Update represents setting that field in the
// current struct. Other fields in this struct represent record fields that can
// themselves be partially updated.
type Link_PartialUpdate struct {
	Set_Fields Link_PartialUpdate_Set_Fields
}

func (l *Link_PartialUpdate) MarshalRestLiPatch(writer restlicodec.Writer) (err error) {
	return writer.WriteMap(func(keyWriter func(string) restlicodec.Writer) (err error) {
		checker := patch.PartialUpdateFieldChecker{RecordType: "com.linkedin.restli.common.Link"}
		if err = checker.CheckField(writer, "rel", false, l.Set_Fields.Rel != nil, false); err != nil {
			return err
		}
		if err = checker.CheckField(writer, "href", false, l.Set_Fields.Href != nil, false); err != nil {
			return err
		}
		if err = checker.CheckField(writer, "type", false, l.Set_Fields.Type != nil, false); err != nil {
			return err
		}
		if checker.HasSets {
			err = l.Set_Fields.MarshalRestLi(keyWriter("$set"))
			if err != nil {
				return err
			}
		}

		return nil
	})
}

func (l *Link_PartialUpdate) MarshalRestLi(writer restlicodec.Writer) (err error) {
	return writer.WriteMap(func(keyWriter func(string) restlicodec.Writer) (err error) {
		return l.MarshalRestLiPatch(keyWriter(patch.PatchField).SetScope())
	})
}

func (l *Link_PartialUpdate) MarshalJSON() (data []byte, err error) {
	writer := restlicodec.NewCompactJsonWriter()
	err = l.MarshalRestLi(writer)
	if err != nil {
		return nil, err
	}
	return []byte(writer.Finalize()), nil
}

func (l *Link_PartialUpdate) UnmarshalRestLiPatch(reader restlicodec.Reader) (err error) {
	err = reader.ReadMap(func(reader restlicodec.Reader, key string) (err error) {
		switch key {
		case "$set":
			err = l.Set_Fields.UnmarshalRestLi(reader)
		default:
			err = reader.Skip()
		}
		return err
	})
	if err != nil {
		return err
	}
	checker := patch.PartialUpdateFieldChecker{RecordType: "com.linkedin.restli.common.Link"}
	if err = checker.CheckField(reader, "rel", false, l.Set_Fields.Rel != nil, false); err != nil {
		return err
	}
	if err = checker.CheckField(reader, "href", false, l.Set_Fields.Href != nil, false); err != nil {
		return err
	}
	if err = checker.CheckField(reader, "type", false, l.Set_Fields.Type != nil, false); err != nil {
		return err
	}
	return nil
}

func (l *Link_PartialUpdate) UnmarshalRestLi(reader restlicodec.Reader) (err error) {
	return reader.ReadRecord(patch.RequiredPatchRecordFields, func(reader restlicodec.Reader, field string) (err error) {
		if field == patch.PatchField {
			return l.UnmarshalRestLiPatch(reader)
		} else {
			return reader.Skip()
		}
	})
}

func (l *Link_PartialUpdate) UnmarshalJSON(data []byte) error {
	return restlicodec.UnmarshalJSON(data, l)
}

func (l *Link_PartialUpdate) NewInstance() *Link_PartialUpdate {
	return new(Link_PartialUpdate)
}
